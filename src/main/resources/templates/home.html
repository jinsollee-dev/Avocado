<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic.html}">


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


<div layout:fragment="content">

  <!--배너 이미지-->
  <div class="hero">
    <div class="hero-slide">
      <div
              class="img overlay"
              style="background-image: url('/images/product1.jpg')"
      ></div>
      <div
              class="img overlay"
              style="background-image: url('/images/product2.jpg')"
      ></div>
      <div
              class="img overlay"
              style="background-image: url('/images/product4.jpg')"
      ></div>
    </div>

    <div class="container">
      <!--검색창-->
      <div class="row justify-content-center align-items-center">
        <div class="col-lg-9 text-center">
          <h1 class="heading" data-aos="fade-up">
            국내 최대 중고물품 거래사이트
          </h1>
          <form
                  th:action="@{/}" method="get"
                  class="narrow-w form-search d-flex align-items-stretch mb-3"
                  data-aos="fade-up"
                  data-aos-delay="200"
          >
            <input  name="searchQuery"
                    type="search"
                    class="form-control px-4"
                    placeholder="찾고 싶은 물건을 적어보세요"
            />
            <button type="submit" class="btn btn-primary">search</button>
          </form>
        </div>
      </div>
    </div>
  </div>


  <div class="section">
  <div class="container">

    <input type="hidden" name="searchQuery" th:value="${ProductSearchDto.searchQuery}">
    <div th:if="${not #strings.isEmpty(ProductSearchDto.searchQuery)}" class="center">
      <p class="h3 font-weight-bold" th:text="${ProductSearchDto.searchQuery} + ' 검색 결과'"></p>
    </div>

    <div class="row">
      <th:block th:each="product, status: ${products.getContent()}">
        <div class="col-md-4 margin" style="margin-bottom: 30px">
          <div class="card">
            <a th:href="'/product/' +${product.pno}" class="text-dark">
              <img th:src="|${product.imgUrl}|" class="card-img-top" th:alt="${product.pname}" height="300">
              <div class="card-body">
                <h4 class="card-title">[[${product.pname}]]</h4>
                <p class="card-text">[[${product.writer}]]</p>
                <h3 class="card-title text-danger">[[${product.price}]]원</h3>
              </div>
            </a>
          </div>
        </div>
      </th:block>
    </div>

    <div th:with="start=${(products.number/maxPage)*maxPage + 1},
    end=(${(products.totalPages == 0) ? 1 : (start + (maxPage - 1) < products.totalPages ? start + (maxPage - 1) : products.totalPages)})">
      <ul class="pagination justify-content-center">

        <li class="page-product" th:classappend="${products.number eq 0}?'disabled':''">
          <a th:href="@{'/' + '?searchQuery=' + ${ProductSearchDto.searchQuery} + '&page=' + ${products.number -1}}"
             aria-label='Previous' class="page-link">
            <span aria-hidden='true'>Previous</span>
          </a>
        </li>

        <li class="page-product" th:each="page: ${#numbers.sequence(start, end)}"
            th:classappend="${products.number eq page -1}?'active':''">
          <a th:href="@{'/' +'?searchQuery=' + ${ProductSearchDto.searchQuery} + '&page=' + ${page -1}}"
             th:inline="text" class="page-link">[[${page}]]</a>
        </li>

        <li class="page-product" th:classappend="${products.number+1 ge products.totalPages}?'disabled':''">
          <a th:href="@{'/' +'?searchQuery=' + ${ProductSearchDto.searchQuery} + '&page=' + ${products.number+1}}"
             aria-label='Next' class="page-link">
            <span aria-hidden='true'>Next</span>
          </a>
        </li>

      </ul>
    </div>
  </div>
  </div>
</div><!--content블럭 끝-->



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>